# Telegram-Bot
Данный репозиторий представляет собой финальный проект в Deep learning school от МФТИ - telegram bot, который осуществляет перенос стиля одной фотографии на другую.

## Описание работы
В боте реализованы два алгоритма для переноса стиля:

### 1. Neural-Style algorithm
Определяются два расстояния, одно для содержания (измеряет, насколько различаются два изображения по своему содержанию) и одно для стиля (измеряет, насколько отличается стиль двух изображений). Затем мы берём третье изображение (в данной реализации это изображение, на которое собираемся переносить стиль), и преобразуем его, чтобы минимизировать два вышеприведённых расстояния.

### 2. Multi-style Generative Network (https://github.com/zhanghang1989/PyTorch-Multi-Style-Transfer)
Сначала происходит генерация картинок с помощью сиамской сети (архитектура нейросети, которая обучается дифференцированию входных данных, при этом каждый класс берёт лишь по одному примеру из выборки).  Затем, авторы статьи добавляют предобученную нейронную сеть (в данном случае — VGG). Сеть выдаёт всё более релевантные результаты благодаря минимизации функции потерь (loss function), которая сводит к минимуму разницу между основной картинкой и стилем с таргетами. Архитектура сети состоит из нескольких частей. Inspiration слой настраивает карту признаков с помощью матрицы Грама. ConvLayer представляет собой обычный сверточный слой Conv2d с паддингом. Bottleneck — это слой, который содержит несколько узлов по сравнению с предыдущими слоями. Его можно использовать для получения представления ввода с уменьшенной размерностью.
![image](https://user-images.githubusercontent.com/77489392/123624384-29ad4200-d817-11eb-99a5-cdbd05f081c7.png)

## Описание файлов

### bot.py
В данном файле содержится основной код бота: реализация всех хэндлеров и функций для запуска алгоритмов.

### messages.py
В данном файле представлены все сообщения, отправляемые пользователю.

### keyboards.py
В данном файле реализованы клавиатуры, появляющиеся в процессе взаимодействия пользователя и бота.

### style_transfer_NN.py
В данном файле содержится реализация **Neural-Style algorithm**.

### MSGNet.py
В данном файле содержится реализация **Multi-style Generative Network**.

### 21styles.model
Данный файл представляет собой веса предобученной модели, которые загружаются в процессе работы бота.
